{"version":3,"file":"main.1ed8dc20cc430f70.hot-update.js","sources":["file://D:\\Project\\GoodsDesign\\GoodsDesign-Mobile\\src\\pages\\LoginPage.tsx","file://D:\\Project\\GoodsDesign\\GoodsDesign-Mobile\\src\\global.css"],"sourcesContent":["import { useState, useEffect } from \"@lynx-js/react\";\nimport { useNavigate } from \"react-router\";\nimport { PictureEnum, pictureMap } from \"../components/images.jsx\";\nimport { useAuthStore } from \"../stores/auth.store.js\";\nimport { API_URL } from \"../graphql/constants.js\";\nimport { LOGIN_MUTATION } from \"../graphql/queries/auth.js\";\n\nexport default function LoginPage() {\n  const nav = useNavigate();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [notification, setNotification] = useState(\"\");\n  const login = useAuthStore((state) => state.login);\n  const accessToken = useAuthStore((state) => state.accessToken);\n\n  useEffect(() => {\n    if (accessToken) {\n      nav(\"/task\", { replace: true });\n    }\n  }, [accessToken, nav]);\n\n  const handleLogin = async () => {\n    if (!email || !password) {\n      setNotification(\"Email and password are required\");\n      return;\n    }\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(API_URL, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          query: LOGIN_MUTATION,\n          variables: {\n            loginInput: {\n              email: email,\n              password: password,\n            },\n          },\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! Status: ${response.status}`);\n      }\n\n      const result = await response.json();\n\n      if (result.errors) {\n        const errorMessage =\n          result.errors[0]?.message || \"An error occurred during login.\";\n        setNotification(errorMessage);\n        return;\n      }\n\n      const loginResult = result.data?.login;\n\n      if (!loginResult) {\n        setNotification(\"Login failed: No data returned.\");\n        return;\n      }\n\n      login({\n        accessToken: loginResult.accessToken,\n        refreshToken: loginResult.refreshToken,\n        user: loginResult.user,\n      });\n      setNotification(\"Login successful\");\n      console.log(\"Login successful\");\n      nav(\"/task\", { replace: true });\n    } catch (error) {\n      setNotification(\n        error instanceof Error ? error.message : \"An unknown error occurred\"\n      );\n      console.error(\"Login error\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleEmailChange = (event: any) => {\n    setEmail(event.detail.value);\n  };\n\n  const handlePasswordChange = (event: any) => {\n    setPassword(event.detail.value);\n  };\n\n  return (\n    <view\n      style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        padding: \"4rem 1.5rem\",\n        backgroundColor: \"white\",\n        height: \"100vh\",\n      }}\n    >\n      <view\n        style={{\n          width: \"100%\",\n          maxWidth: \"32rem\",\n          boxShadow: \"0 1px 3px 0 rgb(0 0 0 / 0.1)\",\n          borderRadius: \"1.5rem\",\n          padding: \"1.5rem\",\n          marginTop: \"-6rem\",\n          backgroundColor: \"white\",\n        }}\n      >\n        {/* Header */}\n        <view\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            alignItems: \"center\",\n            marginBottom: \"2.5rem\",\n          }}\n        >\n          <image\n            style={{ width: \"5rem\", height: \"5rem\", marginBottom: \"1rem\" }}\n            src={pictureMap[PictureEnum.Logo].src}\n          />\n          <text\n            style={{\n              fontSize: \"2.25rem\",\n              fontWeight: \"bold\",\n              color: \"#1e293b\",\n            }}\n          >\n            GoodsDesign\n          </text>\n          <text\n            style={{\n              fontSize: \"1.125rem\",\n              color: \"#64748b\",\n              marginTop: \"0.5rem\",\n            }}\n          >\n            Sign in to your staff account\n          </text>\n        </view>\n\n        {/* Email Field */}\n        <view style={{ marginBottom: \"1.5rem\" }}>\n          <text\n            style={{\n              fontSize: \"1rem\",\n              fontWeight: \"500\",\n              color: \"#334155\",\n              marginBottom: \"0.5rem\",\n            }}\n          >\n            Email\n          </text>\n          <input\n            type=\"text\"\n            placeholder=\"Enter your email\"\n            value={email}\n            bindinput={handleEmailChange}\n            style={{\n              width: \"100%\",\n              height: \"3.5rem\",\n              padding: \"0 1.25rem\",\n              border: \"1px solid #cbd5e1\",\n              borderRadius: \"0.75rem\",\n              fontSize: \"1.125rem\",\n              backgroundColor: \"white\",\n            }}\n          />\n        </view>\n\n        {/* Password Field */}\n        <view style={{ marginBottom: \"2rem\" }}>\n          <text\n            style={{\n              fontSize: \"1rem\",\n              fontWeight: \"500\",\n              color: \"#334155\",\n              marginBottom: \"0.5rem\",\n            }}\n          >\n            Password\n          </text>\n          <input\n            type=\"password\"\n            placeholder=\"Enter your password\"\n            value={password}\n            bindinput={handlePasswordChange}\n            style={{\n              width: \"100%\",\n              height: \"3.5rem\",\n              padding: \"0 1.25rem\",\n              border: \"1px solid #cbd5e1\",\n              borderRadius: \"0.75rem\",\n              fontSize: \"1.125rem\",\n              backgroundColor: \"white\",\n            }}\n          />\n        </view>\n\n        {/* Login Button */}\n        <view\n          bindtap={handleLogin}\n          style={{\n            height: \"3.5rem\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            borderRadius: \"0.75rem\",\n            backgroundColor: isLoading ? \"#818cf8\" : \"#6366f1\",\n            opacity: !email || !password ? 0.6 : 1,\n          }}\n        >\n          <text\n            style={{ color: \"white\", fontSize: \"1.125rem\", fontWeight: \"600\" }}\n          >\n            {isLoading ? \"Signing in...\" : \"Sign in\"}\n          </text>\n        </view>\n\n        {/* Notification Display */}\n        {notification && (\n          <view\n            style={{\n              marginTop: \"1rem\",\n              padding: \"1rem\",\n              backgroundColor: \"#e0e7ff\",\n              borderRadius: \"0.75rem\",\n            }}\n          >\n            <text style={{ color: \"#4f46e5\", marginTop: \"0.25rem\" }}>\n              {notification}\n            </text>\n          </view>\n        )}\n      </view>\n    </view>\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport {};\n  if (module.hot) {\n    (function() {\n      var localsJsonString = undefined;\n      // 1746610290538\n      var cssReload = require(\"../node_modules/@lynx-js/css-extract-webpack-plugin/runtime/hotModuleReplacement.cjs\")(module.id, {}, \"\");\n      // only invalidate when locals change\n      if (\n        module.hot.data &&\n        module.hot.data.value &&\n        module.hot.data.value !== localsJsonString\n      ) {\n        module.hot.invalidate();\n      } else {\n        module.hot.accept();\n      }\n      module.hot.dispose(function(data) {\n        data.value = localsJsonString;\n        cssReload();\n      });\n    })();\n  }"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;AAsNA;;;;;;;;AASA;;AAOA;;;;;;;;;;;;;;;AA7IA;;AAUA;;;AAYA;;;AAQA;;;AAIA;;;;;AASA;;;;;AAWA;;;AAEA;;;;AASA;AACA;AACA;AAGA;;;AAaA;;;AAEA;;;;AASA;AACA;AACA;AAGA;;;AAgBA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA9MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AA8BA;AA7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;;AAiCA;AAqCA;AACA;AA4BA;AACA;AAeA;;AAOA;AACA;;;;AAGA;AAGA;;;;;;;AAKA;AAUA;;;;;;;;;;;;;AAOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}